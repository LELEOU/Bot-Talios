# Pre-commit Hooks - Verifica√ß√µes autom√°ticas antes de cada commit
# https://pre-commit.com

# Para instalar: pre-commit install
# Para rodar manualmente: pre-commit run --all-files

default_language_version:
  python: python3.11

repos:
  # ============================================================================
  # RUFF - Linter e Formatter Python
  # ============================================================================
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.9.0
    hooks:
      # Linter
      - id: ruff
        name: üîç Ruff Linter
        args: [--fix, --exit-non-zero-on-fix]
      
      # Formatter
      - id: ruff-format
        name: üé® Ruff Formatter

  # ============================================================================
  # PRE-COMMIT HOOKS PADR√ÉO
  # ============================================================================
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      # Remove espa√ßos em branco no fim das linhas
      - id: trailing-whitespace
        name: ‚úÇÔ∏è  Remove trailing whitespace
      
      # Adiciona linha em branco no fim dos arquivos
      - id: end-of-file-fixer
        name: üìù Fix end of files
      
      # Verifica sintaxe YAML
      - id: check-yaml
        name: ‚úÖ Check YAML
        args: [--safe]
      
      # Verifica sintaxe JSON
      - id: check-json
        name: ‚úÖ Check JSON
      
      # Verifica sintaxe TOML
      - id: check-toml
        name: ‚úÖ Check TOML
      
      # Previne commits de arquivos grandes
      - id: check-added-large-files
        name: üö´ Check large files
        args: [--maxkb=1000]
      
      # Detecta merge conflicts
      - id: check-merge-conflict
        name: üîÄ Check merge conflicts
      
      # Previne commits diretos em main/master
      - id: no-commit-to-branch
        name: üö´ No commit to main
        args: [--branch, main, --branch, master]
      
      # Verifica se arquivos Python s√£o v√°lidos
      - id: check-ast
        name: ‚úÖ Check Python AST
      
      # Verifica docstrings
      - id: check-docstring-first
        name: üìö Check docstring first
      
      # Detecta credenciais hardcoded
      - id: detect-private-key
        name: üîí Detect private keys
      
      # Ordena requirements.txt
      - id: requirements-txt-fixer
        name: üì¶ Sort requirements.txt

  # ============================================================================
  # PYRIGHT - Type Checker
  # ============================================================================
  - repo: https://github.com/RobertCraigie/pyright-python
    rev: v1.1.400
    hooks:
      - id: pyright
        name: üî¨ Pyright Type Check
        additional_dependencies:
          - discord.py
          - aiosqlite
          - python-dotenv

  # ============================================================================
  # PRETTIER - Formatter para YAML, JSON, Markdown
  # ============================================================================
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        name: üíÖ Prettier (YAML/JSON/MD)
        types_or: [yaml, json, markdown]

  # ============================================================================
  # CODESPELL - Corretor ortogr√°fico
  # ============================================================================
  - repo: https://github.com/codespell-project/codespell
    rev: v2.3.0
    hooks:
      - id: codespell
        name: üìù Check spelling
        args: [--skip, "*.pyc,*.pyo,*.git,*.nox"]
        exclude: ^(locales/.*\.json)$  # Ignora arquivos de tradu√ß√£o

# ============================================================================
# CONFIGURA√á√ÉO CI (GitHub Actions, etc)
# ============================================================================
ci:
  autofix_commit_msg: |
    ü§ñ [pre-commit.ci] auto fixes from pre-commit hooks
    
    for more information, see https://pre-commit.ci
  
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: 'üîß [pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: [pyright]  # Pyright √© pesado, rodar apenas localmente
  submodules: false
